# –ó–∞–¥–∞–Ω–∏–µ 1.1

## –¢–µ–∫—É—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- –ü–æ–ª—É—á–µ–Ω–∏–µ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ø–æ ID
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ø–æ ID
- –í–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ø–æ ID
- –í—ã–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ø–æ ID
- –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –¥–ª—è –Ω–∞–≥—Ä–µ–≤–∞—Ç–µ–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –ø–æ ID (–≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –¥–∞—Ç—á–∏–∫–æ–º —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã)
- –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–π —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã —Å–∏—Å—Ç–µ–º—ã –ø–æ –µ–µ ID

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

[C4 —Å—Ö–µ–º–∞](./task_1.1.puml)

–Ø–∑—ã–∫: Java
–°–£–ë–î: Postgresql

–°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–æ–ª–∏—Ç–Ω–∞—è, —Å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ–º –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä, —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ —Å–µ—Ä–≤–∏—Å. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–∏—Å–µ.
–ó–∞–ø—Ä–æ—Å—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ.
–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤—Å—é —Å–∏—Å—Ç–µ–º—É —Ü–µ–ª–∏–∫–æ–º.

–°—É–¥—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –∫ –∫–æ–Ω–µ—á–Ω–æ–º—É –ø—Ä–æ–¥—É–∫—Ç—É, –∫–æ–º–∞–Ω–¥—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –ø—Ä–∏–¥–µ—Ç—Å—è —Ä–∞—à–∏—Ä—è—Ç—å. –ü—Ä–µ–¥–ª–æ–≥–∞–µ—Ç—Å—è —á–∞—Å—Ç—å –∫–æ–º–∞–Ω–¥—ã –æ—Å—Ç–∞–≤–∏—Ç—å –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ legacy –Ω–∞ –≤—Ä–µ–º—è –ø–µ—Ä–µ–µ–∑–¥–∞ –Ω–∞ —Å–µ—Ä–≤–∏—Å—ã.
–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –ø—Ä–∏–¥–µ—Ç—Å—è –Ω–∞–Ω–∏–º–∞—Ç—å –ª—é–¥–µ–π, –ø–æ—á–µ–º—É –±—ã –ø—Ä–∏ —ç—Ç–æ–º –Ω–µ –ø–µ—Ä–µ–µ—Ö–∞—Ç—å –Ω–∞ –≥–æ? üòÄ

## –î–æ–º–µ–Ω—ã

1. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏. –†–µ–∞–ª–∏–∑—É–µ—Ç CRUDL —É—Å—Ç—Ä–æ–π—Å—Ç–≤, –æ—Ç–ø—Ä–∞–≤–∫—É –∫–æ–º–∞–Ω–¥ –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ.
2. –¢–µ–ª–µ–º–µ—Ç—Ä–∏—è. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç —Ç–µ–ª–µ–º–µ—Ç—Ä–∏—é –æ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤.
3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏. CRUDL –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —Ä–æ–ª–µ–≤–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞.
4. –£–º–Ω—ã–π –¥–æ–º. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –≤ —Å—É—â–Ω–æ—Å—Ç—å –¥–æ–º–∞. –°–≤—è–∑—å –¥–æ–º–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. CRUDL –ø–æ–º–µ—â–µ–Ω–∏–π –∏ –¥–æ–º–æ–≤.
5. –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏. CRUDL —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –ü—Ä–∏–µ–º —Å–æ–±—ã—Ç–∏–π –æ—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤ –∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥.

# –ó–∞–¥–∞–Ω–∏–µ 1.2

–ò–¥–µ—è –¥–ª—è –ø—Ä–∏–µ–º–Ω–∏–∫–∞ —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏ –≤ —Ç–æ–º, —á—Ç–æ–±—ã —Ä–∞–∑–Ω–µ—Å—Ç–∏ –∑–∞–¥–∞—á–∏ –ø—Ä–∏–µ–º–∞, –æ–±—Ä–∞–±–æ—Ç–∫–∏, —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏.
–ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö, –æ–Ω–∏ –ø–æ–ø–∞–¥–∞—é—Ç –≤ kafka –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å–≤—É—é—â–∏–π —Ç–æ–ø–∏–∫. –ò–∑ —Ç–æ–ø–∏–∫–∞ –∏—Ö —á–∏—Ç–∞–µ—Ç –ø–∞—Ä—Å–µ—Ä –¥–ª—è –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–º—É –≤–∏–¥—É. –ü–æ—Å–ª–µ —á–µ–≥–æ, –¥–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ.

–ü—Ä–∏ –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏–∏ –∑–∞–ø—Ä–æ—Å–∞ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –¥–∞–Ω–Ω—ã–µ —á–∏—Ç–∞—é—Ç—Å—è –∏–∑ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.

–°—Ö–µ–º—ã:
- [–°—Ö–µ–º–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤](task_1.2_containers%20copy.puml)
- [–°—Ö–µ–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ä–∞–∑–±–æ—Ä–∞–¥–∞–Ω–Ω—ã–µ—Ö —Å–µ–Ω—Å–æ—Ä–∞](./task_1.2_containers%20copy.puml)

## –ó–∞–¥–∞–Ω–∏–µ 1.3

- [–°—Ö–µ–º–∞ —Ç–∞–±–ª–∏—Ü](./task_1.3_er.puml)

## –ó–∞–¥–∞–Ω–∏–µ 1.4

- [swagger –æ–ø–∏—Å–∞–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏](./task_1.4_command_swagger.yaml)

# –ó–∞–¥–∞–Ω–∏–µ 2

## –ó–∞–ø—É—Å–∫

–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –ø–æ–¥–Ω–∏–º–∞—é—Ç—Å—è –ø—Ä–∏ –ø–æ–º–æ—â–∏ `docker compose` —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

```bash
sudo docker compose up
```

–ü—Ä–∏ —ç—Ç–æ–º, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —á—Ç–æ–±—ã –≤ –ø–∞–ø–∫–µ –±—ã–ª `.env` —Ñ–∞–π–ª, –∫–∞–∫ –ø—Ä–∏–º–µ—Ä:
```
POSTGRES_USER=your_username
POSTGRES_PASSWORD=your_password
POSTGRES_DB=smart_home
```

## –¢–µ—Å—Ç—ã

–ß—Ç–æ–±—ã –±—ã–ª–æ —É–¥–æ–±–Ω–æ —Å–¥–µ–ª–∞–ª [swagger](./swagger.yaml) —Ñ–∞–π–ª —Å–æ –≤—Å–µ–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏. –í –Ω–µ–º 2 —Å–µ—Ä–≤–µ—Ä–∞ 192 (–º–æ–π —É–¥–∞–ª–µ–Ω–Ω—ã–π –¥–ª—è —Ç–µ—Å—Ç–æ–≤)
–∏ localhost –µ—Å–ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ.

## –°–µ—Ä–≤–∏—Å—ã

|–°–µ—Ä–≤–∏—Å     | –ü–æ—Ä—Ç |
|-----------|------|
|zookeeper  | 2181 |
|kafka 1    | 29092|
|kafka 2    | 29093|
|kafka-ui   | 8090 |
|telemetry  | 8010 |
|devices    | 8030 |
|monolith-db| 15432|
|monolith   | 8020 |
|kong       |8001, 8444, 8000, 8443, 9080, 9081 |
|prometheus | 9090 |
|grafana    | 3000 |

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏–≤ —Å–∏—Å—Ç–µ–º—É –ø—Ä–∏ –ø–æ–º–æ—â–∏ –∫–æ–º–∞–Ω–¥—ã
```bash
sudo docker compose up
```

–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å —Å–ª–µ–¥—É—é—â–∏–µ –ø—É—Ç–∏:
- `/api/heating` - –º–∞—Ä—à—Ä—É—Ç–∏–∑—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –º–æ–Ω–æ–ª–∏—Ç
- `/telemetry` - –º–∞—Ä—à—Ä—É—Ç–∏–∑—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–µ—Ä–≤–∏—Å —Ç–µ–ª–µ–º–µ—Ç—Ä–∏–∏
- `/device` - –º–∞—Ä—à—Ä—É—Ç–∏–∑—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏
- `/command` - –º–∞—Ä—à—Ä—É—Ç–∏–∑—É–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —Å–µ—Ä–≤–∏—Å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º–∏ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥

